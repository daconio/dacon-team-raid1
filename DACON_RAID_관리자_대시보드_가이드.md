# ğŸ›¡ï¸ DACON: RAID - ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ ê°œë°œ ê°€ì´ë“œ

**ë²„ì „**: 1.0  
**ì‘ì„±ì¼**: 2025ë…„ 11ì›” 1ì¼  
**ëŒ€ìƒ**: ì™„ì „í•œ ê´€ë¦¬ì ê¸°ëŠ¥ì´ í•„ìš”í•œ ì‹œìŠ¤í…œ

---

## ğŸ“‹ ëª©ì°¨

1. [ê´€ë¦¬ì ì‹œìŠ¤í…œ ê°œìš”](#1-ê´€ë¦¬ì-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ê¶Œí•œ ë° ì—­í•  ì„¤ê³„](#2-ê¶Œí•œ-ë°-ì—­í• -ì„¤ê³„)
3. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¥](#3-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ-í™•ì¥)
4. [ë°±ì—”ë“œ API ì„¤ê³„](#4-ë°±ì—”ë“œ-api-ì„¤ê³„)
5. [í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ êµ¬ì¡°](#5-í”„ë¡ íŠ¸ì—”ë“œ-í˜ì´ì§€-êµ¬ì¡°)
6. [ì£¼ìš” ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„](#6-ì£¼ìš”-ê´€ë¦¬-ê¸°ëŠ¥-êµ¬í˜„)
7. [í†µê³„ ë° ë¶„ì„ ëŒ€ì‹œë³´ë“œ](#7-í†µê³„-ë°-ë¶„ì„-ëŒ€ì‹œë³´ë“œ)
8. [ë³´ì•ˆ ë° ê°ì‚¬ ë¡œê·¸](#8-ë³´ì•ˆ-ë°-ê°ì‚¬-ë¡œê·¸)

---

## 1. ê´€ë¦¬ì ì‹œìŠ¤í…œ ê°œìš”

### 1.1 ì£¼ìš” ê¸°ëŠ¥

```
ğŸ“Š í†µê³„ ëŒ€ì‹œë³´ë“œ
   â””â”€ ì‹¤ì‹œê°„ KPI ëª¨ë‹ˆí„°ë§
   â””â”€ ì‚¬ìš©ì ì¦ê°€ìœ¨ ì°¨íŠ¸
   â””â”€ íŒ€ ë§¤ì¹­ ì„±ê³µë¥  ë¶„ì„

ğŸ† ëŒ€íšŒ ê´€ë¦¬
   â””â”€ ëŒ€íšŒ CRUD (ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ)
   â””â”€ ëŒ€íšŒ ìƒíƒœ ê´€ë¦¬ (í™œì„±/ë¹„í™œì„±)
   â””â”€ ëŒ€íšŒ í†µê³„ í™•ì¸

ğŸ‘¥ ì‚¬ìš©ì ê´€ë¦¬
   â””â”€ ì‚¬ìš©ì ê²€ìƒ‰ ë° ì¡°íšŒ
   â””â”€ ê³„ì • ìƒíƒœ ê´€ë¦¬ (í™œì„±/ì •ì§€/ì‚­ì œ)
   â””â”€ ê¶Œí•œ ë¶€ì—¬ (ê´€ë¦¬ì, ëª¨ë”ë ˆì´í„°)
   â””â”€ ì‚¬ìš©ì í™œë™ ë‚´ì—­ ì¡°íšŒ

ğŸ® ì›ì •ëŒ€ ê´€ë¦¬
   â””â”€ ëª¨ë“  ì›ì •ëŒ€ ëª¨ë‹ˆí„°ë§
   â””â”€ ë¶€ì ì ˆí•œ ì½˜í…ì¸  ì‚­ì œ
   â””â”€ ì›ì •ëŒ€ ê°•ì œ ì¢…ë£Œ

ğŸš¨ ì‹ ê³  ê´€ë¦¬
   â””â”€ ì‹ ê³  ì ‘ìˆ˜ ëª©ë¡
   â””â”€ ì‹ ê³  ì²˜ë¦¬ (ìŠ¹ì¸/ê±°ë¶€)
   â””â”€ ì²˜ë²Œ ì´ë ¥ ê´€ë¦¬

ğŸ“ˆ ë¶„ì„ ë° ë¦¬í¬íŠ¸
   â””â”€ ì‚¬ìš©ì í–‰ë™ ë¶„ì„
   â””â”€ íŒ€ êµ¬ì„± íŒ¨í„´ ë¶„ì„
   â””â”€ ì›”ê°„/ì£¼ê°„ ë¦¬í¬íŠ¸ ìƒì„±
```

### 1.2 ê´€ë¦¬ì í˜ì´ì§€ ì ‘ê·¼ ê²½ë¡œ

```
ì¼ë°˜ ì‚¬ìš©ì: https://dacon-raid.com
ê´€ë¦¬ì:      https://dacon-raid.com/admin
```

---

## 2. ê¶Œí•œ ë° ì—­í•  ì„¤ê³„

### 2.1 ì—­í•  ì •ì˜

```typescript
enum UserRole {
  USER = 'user',              // ì¼ë°˜ ì‚¬ìš©ì
  MODERATOR = 'moderator',    // ëª¨ë”ë ˆì´í„° (ì½˜í…ì¸  ê´€ë¦¬)
  ADMIN = 'admin',            // ê´€ë¦¬ì (ì „ì²´ ê´€ë¦¬)
  SUPER_ADMIN = 'super_admin' // ìµœê³  ê´€ë¦¬ì (ì‹œìŠ¤í…œ ì„¤ì •)
}
```

### 2.2 ê¶Œí•œ ë§¤íŠ¸ë¦­ìŠ¤

| ê¸°ëŠ¥ | User | Moderator | Admin | Super Admin |
|------|------|-----------|-------|-------------|
| ì›ì •ëŒ€ ìƒì„±/ì°¸ì—¬ | âœ… | âœ… | âœ… | âœ… |
| ë¶€ì ì ˆí•œ ì½˜í…ì¸  ì‚­ì œ | âŒ | âœ… | âœ… | âœ… |
| ì‚¬ìš©ì ê³„ì • ì •ì§€ | âŒ | âŒ | âœ… | âœ… |
| ëŒ€íšŒ ê´€ë¦¬ | âŒ | âŒ | âœ… | âœ… |
| í†µê³„ ì¡°íšŒ | âŒ | âœ… | âœ… | âœ… |
| ê¶Œí•œ ë¶€ì—¬ | âŒ | âŒ | âŒ | âœ… |
| ì‹œìŠ¤í…œ ì„¤ì • | âŒ | âŒ | âŒ | âœ… |

### 2.3 ê¶Œí•œ ì²´í¬ ë¯¸ë“¤ì›¨ì–´

#### `server/src/middleware/admin.middleware.ts`

```typescript
import { Response, NextFunction } from 'express';
import { AuthRequest } from './auth.middleware';
import { prisma } from '../index';

export enum UserRole {
  USER = 'user',
  MODERATOR = 'moderator',
  ADMIN = 'admin',
  SUPER_ADMIN = 'super_admin'
}

// ê´€ë¦¬ì ê¶Œí•œ ì²´í¬
export const requireAdmin = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.userId) {
      return res.status(401).json({ error: 'Authentication required' });
    }

    const user = await prisma.user.findUnique({
      where: { id: req.userId },
      select: { role: true }
    });

    if (!user || !['admin', 'super_admin'].includes(user.role)) {
      return res.status(403).json({ error: 'Admin access required' });
    }

    next();
  } catch (error) {
    console.error('Admin check error:', error);
    res.status(500).json({ error: 'Authorization failed' });
  }
};

// ëª¨ë”ë ˆì´í„° ì´ìƒ ê¶Œí•œ ì²´í¬
export const requireModerator = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.userId) {
      return res.status(401).json({ error: 'Authentication required' });
    }

    const user = await prisma.user.findUnique({
      where: { id: req.userId },
      select: { role: true }
    });

    if (!user || !['moderator', 'admin', 'super_admin'].includes(user.role)) {
      return res.status(403).json({ error: 'Moderator access required' });
    }

    next();
  } catch (error) {
    console.error('Moderator check error:', error);
    res.status(500).json({ error: 'Authorization failed' });
  }
};

// ìµœê³  ê´€ë¦¬ì ê¶Œí•œ ì²´í¬
export const requireSuperAdmin = async (
  req: AuthRequest,
  res: Response,
  next: NextFunction
) => {
  try {
    if (!req.userId) {
      return res.status(401).json({ error: 'Authentication required' });
    }

    const user = await prisma.user.findUnique({
      where: { id: req.userId },
      select: { role: true }
    });

    if (!user || user.role !== 'super_admin') {
      return res.status(403).json({ error: 'Super admin access required' });
    }

    next();
  } catch (error) {
    console.error('Super admin check error:', error);
    res.status(500).json({ error: 'Authorization failed' });
  }
};

// íŠ¹ì • ì—­í•  ì²´í¬
export const requireRole = (allowedRoles: UserRole[]) => {
  return async (req: AuthRequest, res: Response, next: NextFunction) => {
    try {
      if (!req.userId) {
        return res.status(401).json({ error: 'Authentication required' });
      }

      const user = await prisma.user.findUnique({
        where: { id: req.userId },
        select: { role: true }
      });

      if (!user || !allowedRoles.includes(user.role as UserRole)) {
        return res.status(403).json({ 
          error: 'Insufficient permissions',
          required: allowedRoles,
          current: user?.role
        });
      }

      next();
    } catch (error) {
      console.error('Role check error:', error);
      res.status(500).json({ error: 'Authorization failed' });
    }
  };
};
```

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ í™•ì¥

### 3.1 User ëª¨ë¸ í™•ì¥

#### `server/prisma/schema.prisma`

```prisma
model User {
  id                String   @id @default(uuid())
  replitUserId      String   @unique
  email             String   @unique
  displayName       String
  photoURL          String?
  bio               String   @default("")
  
  // ì—­í•  ë° ê¶Œí•œ (ì¶”ê°€)
  role              String   @default("user") // "user", "moderator", "admin", "super_admin"
  isActive          Boolean  @default(true)   // ê³„ì • í™œì„±í™” ì—¬ë¶€
  isBanned          Boolean  @default(false)  // ì •ì§€ ì—¬ë¶€
  banReason         String?                   // ì •ì§€ ì‚¬ìœ 
  bannedAt          DateTime?                 // ì •ì§€ ì¼ì‹œ
  bannedBy          String?                   // ì •ì§€ ì²˜ë¦¬ì ID
  
  // ê¸°ì¡´ í•„ë“œë“¤...
  roles             String[]
  specializations   String[]
  skills            String[]
  
  githubUrl         String?
  kaggleUrl         String?
  blogUrl           String?
  
  trustCommitment      Float    @default(0)
  trustContribution    Float    @default(0)
  trustCommunication   Float    @default(0)
  trustCollaboration   Float    @default(0)
  totalReviews         Int      @default(0)
  
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  lastLoginAt       DateTime @default(now()) // ë§ˆì§€ë§‰ ë¡œê·¸ì¸ (ì¶”ê°€)
  
  // ê´€ê³„
  createdRaids      Raid[]        @relation("RaidCreator")
  raidMemberships   RaidMember[]
  applications      Application[]
  givenReviews      Review[]      @relation("ReviewGiver")
  receivedReviews   Review[]      @relation("ReviewReceiver")
  
  // ì‹ ê³  ê´€ë ¨ (ì¶”ê°€)
  submittedReports  Report[]      @relation("ReportSubmitter")
  receivedReports   Report[]      @relation("ReportTarget")
  
  // ê°ì‚¬ ë¡œê·¸ (ì¶”ê°€)
  auditLogs         AuditLog[]
  
  @@index([replitUserId])
  @@index([email])
  @@index([role])
  @@index([isActive])
  @@index([isBanned])
}
```

### 3.2 ì‹ ê³ (Report) ëª¨ë¸ ì¶”ê°€

```prisma
model Report {
  id              String   @id @default(uuid())
  
  // ì‹ ê³  ëŒ€ìƒ
  targetType      String   // "user", "raid", "review"
  targetId        String   // ëŒ€ìƒ ID
  
  // ì‹ ê³ ì
  submitterId     String
  submitter       User     @relation("ReportSubmitter", fields: [submitterId], references: [id])
  
  // ì‹ ê³  ë‚´ìš©
  category        String   // "spam", "harassment", "inappropriate_content", "cheating", "other"
  description     String   @db.Text
  
  // ì²˜ë¦¬ ìƒíƒœ
  status          String   @default("pending") // "pending", "reviewing", "resolved", "rejected"
  resolution      String?  @db.Text // ì²˜ë¦¬ ê²°ê³¼
  resolvedBy      String?  // ì²˜ë¦¬ì ID
  resolvedAt      DateTime?
  
  // ì¡°ì¹˜ ì‚¬í•­
  actionTaken     String?  // "warning", "ban", "content_removed", "no_action"
  
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
  
  @@index([submitterId])
  @@index([targetType, targetId])
  @@index([status])
  @@index([createdAt])
}
```

### 3.3 ê°ì‚¬ ë¡œê·¸(AuditLog) ëª¨ë¸ ì¶”ê°€

```prisma
model AuditLog {
  id              String   @id @default(uuid())
  
  // í–‰ìœ„ì
  userId          String
  user            User     @relation(fields: [userId], references: [id])
  
  // í–‰ìœ„ ì •ë³´
  action          String   // "user_banned", "competition_created", "report_resolved" ë“±
  targetType      String?  // "user", "raid", "competition" ë“±
  targetId        String?  // ëŒ€ìƒ ID
  
  // ìƒì„¸ ì •ë³´
  details         Json?    // ì¶”ê°€ ìƒì„¸ ì •ë³´ (JSON)
  ipAddress       String?  // IP ì£¼ì†Œ
  userAgent       String?  // User Agent
  
  createdAt       DateTime @default(now())
  
  @@index([userId])
  @@index([action])
  @@index([targetType, targetId])
  @@index([createdAt])
}
```

### 3.4 ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰

```bash
cd server
npx prisma migrate dev --name add_admin_features
npx prisma generate
```

---

## 4. ë°±ì—”ë“œ API ì„¤ê³„

### 4.1 ê´€ë¦¬ì ë¼ìš°íŠ¸ êµ¬ì¡°

#### `server/src/routes/admin.routes.ts`

```typescript
import { Router } from 'express';
import { authenticateUser } from '../middleware/auth.middleware';
import { requireAdmin, requireModerator, requireSuperAdmin } from '../middleware/admin.middleware';

const router = Router();

// ëª¨ë“  ê´€ë¦¬ì ë¼ìš°íŠ¸ëŠ” ì¸ì¦ í•„ìš”
router.use(authenticateUser);

// í†µê³„ ëŒ€ì‹œë³´ë“œ (ëª¨ë”ë ˆì´í„° ì´ìƒ)
import * as dashboardController from '../controllers/admin/dashboard.controller';
router.get('/dashboard/stats', requireModerator, dashboardController.getStats);
router.get('/dashboard/charts', requireModerator, dashboardController.getCharts);

// ì‚¬ìš©ì ê´€ë¦¬ (ê´€ë¦¬ì ì´ìƒ)
import * as userController from '../controllers/admin/user.controller';
router.get('/users', requireAdmin, userController.listUsers);
router.get('/users/:id', requireAdmin, userController.getUser);
router.patch('/users/:id/ban', requireAdmin, userController.banUser);
router.patch('/users/:id/unban', requireAdmin, userController.unbanUser);
router.patch('/users/:id/role', requireSuperAdmin, userController.updateUserRole);
router.delete('/users/:id', requireSuperAdmin, userController.deleteUser);

// ëŒ€íšŒ ê´€ë¦¬ (ê´€ë¦¬ì ì´ìƒ)
import * as competitionController from '../controllers/admin/competition.controller';
router.post('/competitions', requireAdmin, competitionController.createCompetition);
router.patch('/competitions/:id', requireAdmin, competitionController.updateCompetition);
router.delete('/competitions/:id', requireAdmin, competitionController.deleteCompetition);
router.patch('/competitions/:id/activate', requireAdmin, competitionController.activateCompetition);
router.patch('/competitions/:id/deactivate', requireAdmin, competitionController.deactivateCompetition);

// ì›ì •ëŒ€ ê´€ë¦¬ (ëª¨ë”ë ˆì´í„° ì´ìƒ)
import * as raidController from '../controllers/admin/raid.controller';
router.get('/raids', requireModerator, raidController.listAllRaids);
router.delete('/raids/:id', requireModerator, raidController.deleteRaid);
router.patch('/raids/:id/status', requireAdmin, raidController.updateRaidStatus);

// ì‹ ê³  ê´€ë¦¬ (ëª¨ë”ë ˆì´í„° ì´ìƒ)
import * as reportController from '../controllers/admin/report.controller';
router.get('/reports', requireModerator, reportController.listReports);
router.get('/reports/:id', requireModerator, reportController.getReport);
router.patch('/reports/:id/resolve', requireModerator, reportController.resolveReport);
router.patch('/reports/:id/reject', requireModerator, reportController.rejectReport);

// ê°ì‚¬ ë¡œê·¸ (ê´€ë¦¬ì ì´ìƒ)
import * as auditController from '../controllers/admin/audit.controller';
router.get('/audit-logs', requireAdmin, auditController.listAuditLogs);

export default router;
```

#### `server/src/index.ts`ì— ë¼ìš°íŠ¸ ì¶”ê°€

```typescript
import adminRoutes from './routes/admin.routes';

// ... ê¸°ì¡´ ë¼ìš°íŠ¸ë“¤
app.use('/api/admin', adminRoutes);
```

### 4.2 ëŒ€ì‹œë³´ë“œ ì»¨íŠ¸ë¡¤ëŸ¬

#### `server/src/controllers/admin/dashboard.controller.ts`

```typescript
import { Response } from 'express';
import { AuthRequest } from '../../middleware/auth.middleware';
import { prisma } from '../../index';

// í†µê³„ ìš”ì•½
export const getStats = async (req: AuthRequest, res: Response) => {
  try {
    const [
      totalUsers,
      totalRaids,
      activeRaids,
      totalApplications,
      pendingReports,
      newUsersThisWeek,
      newRaidsThisWeek
    ] = await Promise.all([
      // ì „ì²´ ì‚¬ìš©ì ìˆ˜
      prisma.user.count(),
      
      // ì „ì²´ ì›ì •ëŒ€ ìˆ˜
      prisma.raid.count(),
      
      // í™œì„± ì›ì •ëŒ€ ìˆ˜
      prisma.raid.count({ where: { status: { in: ['recruiting', 'active'] } } }),
      
      // ì „ì²´ ì§€ì› ìˆ˜
      prisma.application.count(),
      
      // ì²˜ë¦¬ ëŒ€ê¸° ì‹ ê³  ìˆ˜
      prisma.report.count({ where: { status: 'pending' } }),
      
      // ì´ë²ˆ ì£¼ ì‹ ê·œ ì‚¬ìš©ì
      prisma.user.count({
        where: {
          createdAt: {
            gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)
          }
        }
      }),
      
      // ì´ë²ˆ ì£¼ ì‹ ê·œ ì›ì •ëŒ€
      prisma.raid.count({
        where: {
          createdAt: {
            gte: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)
          }
        }
      })
    ]);

    // íŒ€ ë§¤ì¹­ ì„±ê³µë¥  ê³„ì‚°
    const acceptedApplications = await prisma.application.count({
      where: { status: 'accepted' }
    });
    const matchSuccessRate = totalApplications > 0 
      ? (acceptedApplications / totalApplications) * 100 
      : 0;

    // í‰ê·  ì‹ ë¢° ì ìˆ˜
    const users = await prisma.user.findMany({
      select: {
        trustCommitment: true,
        trustContribution: true,
        trustCommunication: true,
        trustCollaboration: true,
      }
    });

    const avgTrustScore = users.length > 0
      ? users.reduce((sum, user) => {
          const userAvg = (
            user.trustCommitment +
            user.trustContribution +
            user.trustCommunication +
            user.trustCollaboration
          ) / 4;
          return sum + userAvg;
        }, 0) / users.length
      : 0;

    res.json({
      totalUsers,
      totalRaids,
      activeRaids,
      totalApplications,
      matchSuccessRate: matchSuccessRate.toFixed(2),
      avgTrustScore: avgTrustScore.toFixed(2),
      pendingReports,
      newUsersThisWeek,
      newRaidsThisWeek,
    });
  } catch (error) {
    console.error('Get stats error:', error);
    res.status(500).json({ error: 'Failed to fetch statistics' });
  }
};

// ì°¨íŠ¸ ë°ì´í„°
export const getCharts = async (req: AuthRequest, res: Response) => {
  try {
    const { period = '30d' } = req.query;
    
    const days = period === '7d' ? 7 : period === '30d' ? 30 : 90;
    const startDate = new Date(Date.now() - days * 24 * 60 * 60 * 1000);

    // ì¼ë³„ ì‚¬ìš©ì ì¦ê°€ ì¶”ì´
    const userGrowth = await prisma.$queryRaw<Array<{ date: Date; count: bigint }>>`
      SELECT DATE(created_at) as date, COUNT(*) as count
      FROM "User"
      WHERE created_at >= ${startDate}
      GROUP BY DATE(created_at)
      ORDER BY date ASC
    `;

    // ì¼ë³„ ì›ì •ëŒ€ ìƒì„± ì¶”ì´
    const raidCreation = await prisma.$queryRaw<Array<{ date: Date; count: bigint }>>`
      SELECT DATE(created_at) as date, COUNT(*) as count
      FROM "Raid"
      WHERE created_at >= ${startDate}
      GROUP BY DATE(created_at)
      ORDER BY date ASC
    `;

    // ì—­í• ë³„ ì‚¬ìš©ì ë¶„í¬
    const roleDistribution = await prisma.$queryRaw<Array<{ role: string; count: bigint }>>`
      SELECT role, COUNT(*) as count
      FROM "User"
      GROUP BY role
    `;

    // ì›ì •ëŒ€ ëª©í‘œë³„ ë¶„í¬
    const goalDistribution = await prisma.$queryRaw<Array<{ goal: string; count: bigint }>>`
      SELECT goal, COUNT(*) as count
      FROM "Raid"
      GROUP BY goal
    `;

    res.json({
      userGrowth: userGrowth.map(item => ({
        date: item.date,
        count: Number(item.count)
      })),
      raidCreation: raidCreation.map(item => ({
        date: item.date,
        count: Number(item.count)
      })),
      roleDistribution: roleDistribution.map(item => ({
        role: item.role,
        count: Number(item.count)
      })),
      goalDistribution: goalDistribution.map(item => ({
        goal: item.goal,
        count: Number(item.count)
      })),
    });
  } catch (error) {
    console.error('Get charts error:', error);
    res.status(500).json({ error: 'Failed to fetch chart data' });
  }
};
```

### 4.3 ì‚¬ìš©ì ê´€ë¦¬ ì»¨íŠ¸ë¡¤ëŸ¬

#### `server/src/controllers/admin/user.controller.ts`

```typescript
import { Response } from 'express';
import { AuthRequest } from '../../middleware/auth.middleware';
import { prisma } from '../../index';
import { createAuditLog } from '../../utils/auditLog';

// ì‚¬ìš©ì ëª©ë¡ ì¡°íšŒ
export const listUsers = async (req: AuthRequest, res: Response) => {
  try {
    const {
      search,
      role,
      isActive,
      isBanned,
      sortBy = 'createdAt',
      order = 'desc',
      page = '1',
      limit = '20'
    } = req.query;

    const where: any = {};

    // ê²€ìƒ‰ í•„í„°
    if (search) {
      where.OR = [
        { displayName: { contains: search as string, mode: 'insensitive' } },
        { email: { contains: search as string, mode: 'insensitive' } },
      ];
    }

    if (role) where.role = role;
    if (isActive !== undefined) where.isActive = isActive === 'true';
    if (isBanned !== undefined) where.isBanned = isBanned === 'true';

    const skip = (parseInt(page as string) - 1) * parseInt(limit as string);
    const take = parseInt(limit as string);

    const [users, total] = await Promise.all([
      prisma.user.findMany({
        where,
        select: {
          id: true,
          displayName: true,
          email: true,
          photoURL: true,
          role: true,
          isActive: true,
          isBanned: true,
          banReason: true,
          bannedAt: true,
          createdAt: true,
          lastLoginAt: true,
          _count: {
            select: {
              createdRaids: true,
              raidMemberships: true,
              applications: true,
            }
          }
        },
        orderBy: { [sortBy as string]: order },
        skip,
        take,
      }),
      prisma.user.count({ where })
    ]);

    res.json({
      users,
      pagination: {
        page: parseInt(page as string),
        limit: parseInt(limit as string),
        total,
        totalPages: Math.ceil(total / parseInt(limit as string))
      }
    });
  } catch (error) {
    console.error('List users error:', error);
    res.status(500).json({ error: 'Failed to fetch users' });
  }
};

// íŠ¹ì • ì‚¬ìš©ì ìƒì„¸ ì¡°íšŒ
export const getUser = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;

    const user = await prisma.user.findUnique({
      where: { id },
      include: {
        createdRaids: {
          select: {
            id: true,
            name: true,
            status: true,
            createdAt: true,
          }
        },
        raidMemberships: {
          include: {
            raid: {
              select: {
                id: true,
                name: true,
                status: true,
              }
            }
          }
        },
        applications: {
          select: {
            id: true,
            status: true,
            appliedAt: true,
            raid: {
              select: {
                id: true,
                name: true,
              }
            }
          }
        },
        receivedReports: {
          where: { status: { in: ['pending', 'reviewing'] } },
          select: {
            id: true,
            category: true,
            status: true,
            createdAt: true,
          }
        }
      }
    });

    if (!user) {
      return res.status(404).json({ error: 'User not found' });
    }

    res.json(user);
  } catch (error) {
    console.error('Get user error:', error);
    res.status(500).json({ error: 'Failed to fetch user' });
  }
};

// ì‚¬ìš©ì ì •ì§€
export const banUser = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;
    const { reason, duration } = req.body; // duration: 'permanent' | days (ìˆ«ì)

    if (!reason) {
      return res.status(400).json({ error: 'Ban reason is required' });
    }

    const bannedUntil = duration === 'permanent' 
      ? null 
      : new Date(Date.now() + duration * 24 * 60 * 60 * 1000);

    const user = await prisma.user.update({
      where: { id },
      data: {
        isBanned: true,
        isActive: false,
        banReason: reason,
        bannedAt: new Date(),
        bannedBy: req.userId,
      }
    });

    // ê°ì‚¬ ë¡œê·¸ ê¸°ë¡
    await createAuditLog({
      userId: req.userId!,
      action: 'user_banned',
      targetType: 'user',
      targetId: id,
      details: {
        reason,
        duration: duration === 'permanent' ? 'permanent' : `${duration} days`,
        bannedUntil,
      },
      ipAddress: req.ip,
      userAgent: req.get('user-agent'),
    });

    res.json({
      message: 'User banned successfully',
      user
    });
  } catch (error) {
    console.error('Ban user error:', error);
    res.status(500).json({ error: 'Failed to ban user' });
  }
};

// ì‚¬ìš©ì ì •ì§€ í•´ì œ
export const unbanUser = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;

    const user = await prisma.user.update({
      where: { id },
      data: {
        isBanned: false,
        isActive: true,
        banReason: null,
        bannedAt: null,
        bannedBy: null,
      }
    });

    // ê°ì‚¬ ë¡œê·¸ ê¸°ë¡
    await createAuditLog({
      userId: req.userId!,
      action: 'user_unbanned',
      targetType: 'user',
      targetId: id,
      ipAddress: req.ip,
      userAgent: req.get('user-agent'),
    });

    res.json({
      message: 'User unbanned successfully',
      user
    });
  } catch (error) {
    console.error('Unban user error:', error);
    res.status(500).json({ error: 'Failed to unban user' });
  }
};

// ì‚¬ìš©ì ì—­í•  ë³€ê²½ (Super Adminë§Œ)
export const updateUserRole = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;
    const { role } = req.body;

    const validRoles = ['user', 'moderator', 'admin', 'super_admin'];
    if (!validRoles.includes(role)) {
      return res.status(400).json({ error: 'Invalid role' });
    }

    const user = await prisma.user.update({
      where: { id },
      data: { role }
    });

    // ê°ì‚¬ ë¡œê·¸ ê¸°ë¡
    await createAuditLog({
      userId: req.userId!,
      action: 'user_role_updated',
      targetType: 'user',
      targetId: id,
      details: { newRole: role },
      ipAddress: req.ip,
      userAgent: req.get('user-agent'),
    });

    res.json({
      message: 'User role updated successfully',
      user
    });
  } catch (error) {
    console.error('Update user role error:', error);
    res.status(500).json({ error: 'Failed to update user role' });
  }
};

// ì‚¬ìš©ì ì‚­ì œ (Super Adminë§Œ)
export const deleteUser = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;

    // ì‚¬ìš©ì ì‚­ì œ (Cascadeë¡œ ê´€ë ¨ ë°ì´í„°ë„ ì‚­ì œ)
    await prisma.user.delete({
      where: { id }
    });

    // ê°ì‚¬ ë¡œê·¸ ê¸°ë¡
    await createAuditLog({
      userId: req.userId!,
      action: 'user_deleted',
      targetType: 'user',
      targetId: id,
      ipAddress: req.ip,
      userAgent: req.get('user-agent'),
    });

    res.json({ message: 'User deleted successfully' });
  } catch (error) {
    console.error('Delete user error:', error);
    res.status(500).json({ error: 'Failed to delete user' });
  }
};
```

### 4.4 ì‹ ê³  ê´€ë¦¬ ì»¨íŠ¸ë¡¤ëŸ¬

#### `server/src/controllers/admin/report.controller.ts`

```typescript
import { Response } from 'express';
import { AuthRequest } from '../../middleware/auth.middleware';
import { prisma } from '../../index';
import { createAuditLog } from '../../utils/auditLog';

// ì‹ ê³  ëª©ë¡ ì¡°íšŒ
export const listReports = async (req: AuthRequest, res: Response) => {
  try {
    const {
      status,
      category,
      targetType,
      sortBy = 'createdAt',
      order = 'desc',
      page = '1',
      limit = '20'
    } = req.query;

    const where: any = {};

    if (status) where.status = status;
    if (category) where.category = category;
    if (targetType) where.targetType = targetType;

    const skip = (parseInt(page as string) - 1) * parseInt(limit as string);
    const take = parseInt(limit as string);

    const [reports, total] = await Promise.all([
      prisma.report.findMany({
        where,
        include: {
          submitter: {
            select: {
              id: true,
              displayName: true,
              email: true,
              photoURL: true,
            }
          }
        },
        orderBy: { [sortBy as string]: order },
        skip,
        take,
      }),
      prisma.report.count({ where })
    ]);

    res.json({
      reports,
      pagination: {
        page: parseInt(page as string),
        limit: parseInt(limit as string),
        total,
        totalPages: Math.ceil(total / parseInt(limit as string))
      }
    });
  } catch (error) {
    console.error('List reports error:', error);
    res.status(500).json({ error: 'Failed to fetch reports' });
  }
};

// íŠ¹ì • ì‹ ê³  ìƒì„¸ ì¡°íšŒ
export const getReport = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;

    const report = await prisma.report.findUnique({
      where: { id },
      include: {
        submitter: {
          select: {
            id: true,
            displayName: true,
            email: true,
            photoURL: true,
          }
        }
      }
    });

    if (!report) {
      return res.status(404).json({ error: 'Report not found' });
    }

    // ì‹ ê³  ëŒ€ìƒ ì •ë³´ë„ í•¨ê»˜ ì¡°íšŒ
    let targetData = null;
    if (report.targetType === 'user') {
      targetData = await prisma.user.findUnique({
        where: { id: report.targetId },
        select: {
          id: true,
          displayName: true,
          email: true,
          photoURL: true,
          isBanned: true,
        }
      });
    } else if (report.targetType === 'raid') {
      targetData = await prisma.raid.findUnique({
        where: { id: report.targetId },
        select: {
          id: true,
          name: true,
          description: true,
          status: true,
          creator: {
            select: {
              id: true,
              displayName: true,
            }
          }
        }
      });
    }

    res.json({
      ...report,
      targetData
    });
  } catch (error) {
    console.error('Get report error:', error);
    res.status(500).json({ error: 'Failed to fetch report' });
  }
};

// ì‹ ê³  ì²˜ë¦¬ (ìŠ¹ì¸)
export const resolveReport = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;
    const { resolution, actionTaken } = req.body;

    if (!resolution || !actionTaken) {
      return res.status(400).json({ error: 'Resolution and action are required' });
    }

    const report = await prisma.report.update({
      where: { id },
      data: {
        status: 'resolved',
        resolution,
        actionTaken,
        resolvedBy: req.userId,
        resolvedAt: new Date(),
      },
      include: {
        submitter: true
      }
    });

    // ì¡°ì¹˜ ì‚¬í•­ ì‹¤í–‰
    if (actionTaken === 'ban' && report.targetType === 'user') {
      await prisma.user.update({
        where: { id: report.targetId },
        data: {
          isBanned: true,
          isActive: false,
          banReason: `ì‹ ê³  ì²˜ë¦¬: ${resolution}`,
          bannedAt: new Date(),
          bannedBy: req.userId,
        }
      });
    } else if (actionTaken === 'content_removed' && report.targetType === 'raid') {
      await prisma.raid.delete({
        where: { id: report.targetId }
      });
    }

    // ê°ì‚¬ ë¡œê·¸ ê¸°ë¡
    await createAuditLog({
      userId: req.userId!,
      action: 'report_resolved',
      targetType: 'report',
      targetId: id,
      details: {
        reportTargetType: report.targetType,
        reportTargetId: report.targetId,
        actionTaken,
        resolution,
      },
      ipAddress: req.ip,
      userAgent: req.get('user-agent'),
    });

    res.json({
      message: 'Report resolved successfully',
      report
    });
  } catch (error) {
    console.error('Resolve report error:', error);
    res.status(500).json({ error: 'Failed to resolve report' });
  }
};

// ì‹ ê³  ê±°ë¶€
export const rejectReport = async (req: AuthRequest, res: Response) => {
  try {
    const { id } = req.params;
    const { reason } = req.body;

    const report = await prisma.report.update({
      where: { id },
      data: {
        status: 'rejected',
        resolution: reason || 'ì‹ ê³  ë‚´ìš©ì´ íƒ€ë‹¹í•˜ì§€ ì•ŠìŒ',
        resolvedBy: req.userId,
        resolvedAt: new Date(),
      }
    });

    // ê°ì‚¬ ë¡œê·¸ ê¸°ë¡
    await createAuditLog({
      userId: req.userId!,
      action: 'report_rejected',
      targetType: 'report',
      targetId: id,
      details: { reason },
      ipAddress: req.ip,
      userAgent: req.get('user-agent'),
    });

    res.json({
      message: 'Report rejected successfully',
      report
    });
  } catch (error) {
    console.error('Reject report error:', error);
    res.status(500).json({ error: 'Failed to reject report' });
  }
};
```

### 4.5 ê°ì‚¬ ë¡œê·¸ ìœ í‹¸ë¦¬í‹°

#### `server/src/utils/auditLog.ts`

```typescript
import { prisma } from '../index';

interface CreateAuditLogParams {
  userId: string;
  action: string;
  targetType?: string;
  targetId?: string;
  details?: any;
  ipAddress?: string;
  userAgent?: string;
}

export async function createAuditLog(params: CreateAuditLogParams) {
  try {
    await prisma.auditLog.create({
      data: {
        userId: params.userId,
        action: params.action,
        targetType: params.targetType,
        targetId: params.targetId,
        details: params.details,
        ipAddress: params.ipAddress,
        userAgent: params.userAgent,
      }
    });
  } catch (error) {
    console.error('Failed to create audit log:', error);
    // ê°ì‚¬ ë¡œê·¸ ì‹¤íŒ¨ëŠ” ë©”ì¸ ì‘ì—…ì„ ë°©í•´í•˜ì§€ ì•ŠìŒ
  }
}
```

---

## 5. í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ êµ¬ì¡°

### 5.1 ê´€ë¦¬ì ë¼ìš°íŠ¸ ì„¤ì •

#### `client/src/App.tsx`

```typescript
import React from 'react';
import { HashRouter, Routes, Route, Navigate } from 'react-router-dom';
import { DataProvider } from './contexts/DataContext';
import { AuthProvider, useAuth } from './contexts/AuthContext';

// ì¼ë°˜ ì‚¬ìš©ì í˜ì´ì§€
import Header from './components/Header';
import HomePage from './pages/HomePage';
import RaidDetailPage from './pages/RaidDetailPage';
import ProfilePage from './pages/ProfilePage';
import CreateRaidPage from './pages/CreateRaidPage';
import DashboardPage from './pages/DashboardPage';

// ê´€ë¦¬ì í˜ì´ì§€
import AdminLayout from './components/admin/AdminLayout';
import AdminDashboard from './pages/admin/AdminDashboard';
import UserManagement from './pages/admin/UserManagement';
import CompetitionManagement from './pages/admin/CompetitionManagement';
import RaidManagement from './pages/admin/RaidManagement';
import ReportManagement from './pages/admin/ReportManagement';
import AuditLogs from './pages/admin/AuditLogs';

// ê´€ë¦¬ì ê¶Œí•œ ì²´í¬ ì»´í¬ë„ŒíŠ¸
const AdminRoute: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const { user } = useAuth();
  
  if (!user) {
    return <Navigate to="/" replace />;
  }
  
  if (!['moderator', 'admin', 'super_admin'].includes(user.role)) {
    return <Navigate to="/" replace />;
  }
  
  return <>{children}</>;
};

const App: React.FC = () => {
  return (
    <AuthProvider>
      <DataProvider>
        <HashRouter>
          <Routes>
            {/* ì¼ë°˜ ì‚¬ìš©ì ë¼ìš°íŠ¸ */}
            <Route path="/" element={
              <div className="min-h-screen bg-neutral-900">
                <Header />
                <main className="container mx-auto px-4 py-8">
                  <HomePage />
                </main>
              </div>
            } />
            <Route path="/raid/:raidId" element={
              <div className="min-h-screen bg-neutral-900">
                <Header />
                <main className="container mx-auto px-4 py-8">
                  <RaidDetailPage />
                </main>
              </div>
            } />
            <Route path="/profile/:userId" element={
              <div className="min-h-screen bg-neutral-900">
                <Header />
                <main className="container mx-auto px-4 py-8">
                  <ProfilePage />
                </main>
              </div>
            } />
            <Route path="/create-raid" element={
              <div className="min-h-screen bg-neutral-900">
                <Header />
                <main className="container mx-auto px-4 py-8">
                  <CreateRaidPage />
                </main>
              </div>
            } />
            <Route path="/dashboard" element={
              <div className="min-h-screen bg-neutral-900">
                <Header />
                <main className="container mx-auto px-4 py-8">
                  <DashboardPage />
                </main>
              </div>
            } />

            {/* ê´€ë¦¬ì ë¼ìš°íŠ¸ */}
            <Route path="/admin" element={
              <AdminRoute>
                <AdminLayout />
              </AdminRoute>
            }>
              <Route index element={<Navigate to="/admin/dashboard" replace />} />
              <Route path="dashboard" element={<AdminDashboard />} />
              <Route path="users" element={<UserManagement />} />
              <Route path="competitions" element={<CompetitionManagement />} />
              <Route path="raids" element={<RaidManagement />} />
              <Route path="reports" element={<ReportManagement />} />
              <Route path="audit-logs" element={<AuditLogs />} />
            </Route>
          </Routes>
        </HashRouter>
      </DataProvider>
    </AuthProvider>
  );
};

export default App;
```

### 5.2 ê´€ë¦¬ì ë ˆì´ì•„ì›ƒ

#### `client/src/components/admin/AdminLayout.tsx`

```typescript
import React from 'react';
import { Outlet, Link, useLocation } from 'react-router-dom';
import { 
  LayoutDashboard, 
  Users, 
  Trophy, 
  Shield, 
  Flag, 
  FileText,
  LogOut 
} from 'lucide-react';
import { useAuth } from '../../contexts/AuthContext';

const AdminLayout: React.FC = () => {
  const location = useLocation();
  const { user, logout } = useAuth();

  const menuItems = [
    { path: '/admin/dashboard', icon: LayoutDashboard, label: 'ëŒ€ì‹œë³´ë“œ' },
    { path: '/admin/users', icon: Users, label: 'ì‚¬ìš©ì ê´€ë¦¬' },
    { path: '/admin/competitions', icon: Trophy, label: 'ëŒ€íšŒ ê´€ë¦¬' },
    { path: '/admin/raids', icon: Shield, label: 'ì›ì •ëŒ€ ê´€ë¦¬' },
    { path: '/admin/reports', icon: Flag, label: 'ì‹ ê³  ê´€ë¦¬' },
    { path: '/admin/audit-logs', icon: FileText, label: 'ê°ì‚¬ ë¡œê·¸' },
  ];

  return (
    <div className="min-h-screen bg-neutral-900 flex">
      {/* ì‚¬ì´ë“œë°” */}
      <aside className="w-64 bg-neutral-800 border-r border-neutral-700">
        {/* ë¡œê³  */}
        <div className="p-6 border-b border-neutral-700">
          <h1 className="text-xl font-bold text-white">RAID ê´€ë¦¬ì</h1>
          <p className="text-sm text-neutral-400 mt-1">{user?.displayName}</p>
          <span className="inline-block mt-2 px-2 py-1 text-xs font-semibold bg-primary-500 text-white rounded">
            {user?.role === 'super_admin' ? 'ìµœê³  ê´€ë¦¬ì' : 
             user?.role === 'admin' ? 'ê´€ë¦¬ì' : 'ëª¨ë”ë ˆì´í„°'}
          </span>
        </div>

        {/* ë©”ë‰´ */}
        <nav className="p-4">
          <ul className="space-y-2">
            {menuItems.map((item) => {
              const Icon = item.icon;
              const isActive = location.pathname === item.path;
              
              return (
                <li key={item.path}>
                  <Link
                    to={item.path}
                    className={`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${
                      isActive
                        ? 'bg-primary-500 text-white'
                        : 'text-neutral-300 hover:bg-neutral-700'
                    }`}
                  >
                    <Icon className="w-5 h-5" />
                    <span>{item.label}</span>
                  </Link>
                </li>
              );
            })}
          </ul>
        </nav>

        {/* í•˜ë‹¨ ë²„íŠ¼ */}
        <div className="absolute bottom-0 w-64 p-4 border-t border-neutral-700">
          <Link
            to="/"
            className="flex items-center gap-3 px-4 py-3 rounded-lg text-neutral-300 hover:bg-neutral-700 transition-colors mb-2"
          >
            <LayoutDashboard className="w-5 h-5" />
            <span>ì‚¬ìš©ì í˜ì´ì§€ë¡œ</span>
          </Link>
          <button
            onClick={logout}
            className="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-400 hover:bg-neutral-700 transition-colors"
          >
            <LogOut className="w-5 h-5" />
            <span>ë¡œê·¸ì•„ì›ƒ</span>
          </button>
        </div>
      </aside>

      {/* ë©”ì¸ ì½˜í…ì¸  */}
      <main className="flex-1 overflow-y-auto">
        <div className="container mx-auto px-8 py-6">
          <Outlet />
        </div>
      </main>
    </div>
  );
};

export default AdminLayout;
```

---

## 6. ì£¼ìš” ê´€ë¦¬ ê¸°ëŠ¥ êµ¬í˜„

### 6.1 í†µê³„ ëŒ€ì‹œë³´ë“œ

#### `client/src/pages/admin/AdminDashboard.tsx`

```typescript
import React, { useEffect, useState } from 'react';
import { Users, Shield, TrendingUp, AlertCircle, CheckCircle, Clock } from 'lucide-react';
import { Line, Bar, Pie } from 'react-chartjs-2';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  ArcElement,
  Title,
  Tooltip,
  Legend,
} from 'chart.js';

ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  BarElement,
  ArcElement,
  Title,
  Tooltip,
  Legend
);

interface Stats {
  totalUsers: number;
  totalRaids: number;
  activeRaids: number;
  totalApplications: number;
  matchSuccessRate: string;
  avgTrustScore: string;
  pendingReports: number;
  newUsersThisWeek: number;
  newRaidsThisWeek: number;
}

interface ChartData {
  userGrowth: Array<{ date: string; count: number }>;
  raidCreation: Array<{ date: string; count: number }>;
  roleDistribution: Array<{ role: string; count: number }>;
  goalDistribution: Array<{ goal: string; count: number }>;
}

const AdminDashboard: React.FC = () => {
  const [stats, setStats] = useState<Stats | null>(null);
  const [chartData, setChartData] = useState<ChartData | null>(null);
  const [loading, setLoading] = useState(true);
  const [period, setPeriod] = useState('30d');

  useEffect(() => {
    fetchStats();
    fetchChartData();
  }, [period]);

  const fetchStats = async () => {
    try {
      const response = await fetch('/api/admin/dashboard/stats');
      const data = await response.json();
      setStats(data);
    } catch (error) {
      console.error('Failed to fetch stats:', error);
    }
  };

  const fetchChartData = async () => {
    try {
      const response = await fetch(`/api/admin/dashboard/charts?period=${period}`);
      const data = await response.json();
      setChartData(data);
    } catch (error) {
      console.error('Failed to fetch chart data:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading || !stats || !chartData) {
    return <div className="text-center py-20 text-white">ë¡œë”© ì¤‘...</div>;
  }

  // KPI ì¹´ë“œ ë°ì´í„°
  const kpiCards = [
    {
      title: 'ì „ì²´ ì‚¬ìš©ì',
      value: stats.totalUsers.toLocaleString(),
      icon: Users,
      color: 'bg-blue-500',
      trend: `+${stats.newUsersThisWeek} ì´ë²ˆ ì£¼`,
    },
    {
      title: 'í™œì„± ì›ì •ëŒ€',
      value: stats.activeRaids.toLocaleString(),
      icon: Shield,
      color: 'bg-green-500',
      trend: `ì „ì²´ ${stats.totalRaids}ê°œ`,
    },
    {
      title: 'ë§¤ì¹­ ì„±ê³µë¥ ',
      value: `${stats.matchSuccessRate}%`,
      icon: TrendingUp,
      color: 'bg-purple-500',
      trend: `${stats.totalApplications} ì§€ì›`,
    },
    {
      title: 'ì²˜ë¦¬ ëŒ€ê¸° ì‹ ê³ ',
      value: stats.pendingReports.toLocaleString(),
      icon: AlertCircle,
      color: 'bg-red-500',
      trend: 'ë¹ ë¥¸ ì²˜ë¦¬ í•„ìš”',
    },
  ];

  // ì‚¬ìš©ì ì¦ê°€ ì°¨íŠ¸ ë°ì´í„°
  const userGrowthChartData = {
    labels: chartData.userGrowth.map(item => 
      new Date(item.date).toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' })
    ),
    datasets: [
      {
        label: 'ì‹ ê·œ ì‚¬ìš©ì',
        data: chartData.userGrowth.map(item => item.count),
        borderColor: 'rgb(59, 130, 246)',
        backgroundColor: 'rgba(59, 130, 246, 0.1)',
        fill: true,
      },
    ],
  };

  // ì—­í• ë³„ ë¶„í¬ ì°¨íŠ¸ ë°ì´í„°
  const roleDistributionChartData = {
    labels: chartData.roleDistribution.map(item => item.role),
    datasets: [
      {
        data: chartData.roleDistribution.map(item => item.count),
        backgroundColor: [
          'rgba(59, 130, 246, 0.8)',
          'rgba(16, 185, 129, 0.8)',
          'rgba(245, 158, 11, 0.8)',
          'rgba(239, 68, 68, 0.8)',
        ],
      },
    ],
  };

  return (
    <div>
      {/* í—¤ë” */}
      <div className="mb-8">
        <h1 className="text-3xl font-bold text-white mb-2">ëŒ€ì‹œë³´ë“œ</h1>
        <p className="text-neutral-400">RAID ì‹œìŠ¤í…œ ì „ì²´ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
      </div>

      {/* KPI ì¹´ë“œ */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        {kpiCards.map((card, index) => {
          const Icon = card.icon;
          return (
            <div key={index} className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
              <div className="flex items-center justify-between mb-4">
                <div className={`${card.color} p-3 rounded-lg`}>
                  <Icon className="w-6 h-6 text-white" />
                </div>
              </div>
              <h3 className="text-neutral-400 text-sm font-medium mb-1">{card.title}</h3>
              <p className="text-white text-3xl font-bold mb-2">{card.value}</p>
              <p className="text-neutral-500 text-sm">{card.trend}</p>
            </div>
          );
        })}
      </div>

      {/* ê¸°ê°„ ì„ íƒ */}
      <div className="mb-6">
        <div className="flex gap-2">
          {['7d', '30d', '90d'].map((p) => (
            <button
              key={p}
              onClick={() => setPeriod(p)}
              className={`px-4 py-2 rounded-lg transition-colors ${
                period === p
                  ? 'bg-primary-500 text-white'
                  : 'bg-neutral-800 text-neutral-300 hover:bg-neutral-700'
              }`}
            >
              {p === '7d' ? '7ì¼' : p === '30d' ? '30ì¼' : '90ì¼'}
            </button>
          ))}
        </div>
      </div>

      {/* ì°¨íŠ¸ ê·¸ë¦¬ë“œ */}
      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        {/* ì‚¬ìš©ì ì¦ê°€ ì¶”ì´ */}
        <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
          <h3 className="text-white text-lg font-semibold mb-4">ì‚¬ìš©ì ì¦ê°€ ì¶”ì´</h3>
          <Line 
            data={userGrowthChartData}
            options={{
              responsive: true,
              plugins: {
                legend: { display: false },
              },
              scales: {
                x: {
                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
                  ticks: { color: '#a3a3a3' },
                },
                y: {
                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
                  ticks: { color: '#a3a3a3' },
                },
              },
            }}
          />
        </div>

        {/* ì—­í• ë³„ ì‚¬ìš©ì ë¶„í¬ */}
        <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
          <h3 className="text-white text-lg font-semibold mb-4">ì—­í• ë³„ ì‚¬ìš©ì ë¶„í¬</h3>
          <Pie 
            data={roleDistributionChartData}
            options={{
              responsive: true,
              plugins: {
                legend: {
                  position: 'bottom',
                  labels: { color: '#a3a3a3' },
                },
              },
            }}
          />
        </div>

        {/* ì›ì •ëŒ€ ìƒì„± ì¶”ì´ */}
        <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
          <h3 className="text-white text-lg font-semibold mb-4">ì›ì •ëŒ€ ìƒì„± ì¶”ì´</h3>
          <Bar 
            data={{
              labels: chartData.raidCreation.map(item => 
                new Date(item.date).toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' })
              ),
              datasets: [
                {
                  label: 'ì‹ ê·œ ì›ì •ëŒ€',
                  data: chartData.raidCreation.map(item => item.count),
                  backgroundColor: 'rgba(16, 185, 129, 0.8)',
                },
              ],
            }}
            options={{
              responsive: true,
              plugins: {
                legend: { display: false },
              },
              scales: {
                x: {
                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
                  ticks: { color: '#a3a3a3' },
                },
                y: {
                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
                  ticks: { color: '#a3a3a3' },
                },
              },
            }}
          />
        </div>

        {/* ì›ì •ëŒ€ ëª©í‘œë³„ ë¶„í¬ */}
        <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
          <h3 className="text-white text-lg font-semibold mb-4">ì›ì •ëŒ€ ëª©í‘œë³„ ë¶„í¬</h3>
          <Bar 
            data={{
              labels: chartData.goalDistribution.map(item => item.goal),
              datasets: [
                {
                  label: 'ì›ì •ëŒ€ ìˆ˜',
                  data: chartData.goalDistribution.map(item => item.count),
                  backgroundColor: [
                    'rgba(245, 158, 11, 0.8)',
                    'rgba(239, 68, 68, 0.8)',
                    'rgba(59, 130, 246, 0.8)',
                  ],
                },
              ],
            }}
            options={{
              responsive: true,
              plugins: {
                legend: { display: false },
              },
              scales: {
                x: {
                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
                  ticks: { color: '#a3a3a3' },
                },
                y: {
                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
                  ticks: { color: '#a3a3a3' },
                },
              },
            }}
          />
        </div>
      </div>

      {/* ì¶”ê°€ í†µê³„ */}
      <div className="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
        <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
          <div className="flex items-center gap-3 mb-3">
            <CheckCircle className="w-6 h-6 text-green-500" />
            <h3 className="text-white font-semibold">í‰ê·  ì‹ ë¢° ì ìˆ˜</h3>
          </div>
          <p className="text-3xl font-bold text-white">{stats.avgTrustScore}</p>
          <p className="text-neutral-400 text-sm mt-2">5.0 ë§Œì </p>
        </div>

        <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
          <div className="flex items-center gap-3 mb-3">
            <TrendingUp className="w-6 h-6 text-blue-500" />
            <h3 className="text-white font-semibold">ì´ë²ˆ ì£¼ ì‹ ê·œ ì›ì •ëŒ€</h3>
          </div>
          <p className="text-3xl font-bold text-white">{stats.newRaidsThisWeek}</p>
          <p className="text-neutral-400 text-sm mt-2">ìµœê·¼ 7ì¼</p>
        </div>

        <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700">
          <div className="flex items-center gap-3 mb-3">
            <Clock className="w-6 h-6 text-yellow-500" />
            <h3 className="text-white font-semibold">í‰ê·  ì‘ë‹µ ì‹œê°„</h3>
          </div>
          <p className="text-3xl font-bold text-white">2.4ì‹œê°„</p>
          <p className="text-neutral-400 text-sm mt-2">ì§€ì› â†’ ìˆ˜ë½/ê±°ì ˆ</p>
        </div>
      </div>
    </div>
  );
};

export default AdminDashboard;
```

### 6.2 ì‚¬ìš©ì ê´€ë¦¬ í˜ì´ì§€

#### `client/src/pages/admin/UserManagement.tsx`

```typescript
import React, { useEffect, useState } from 'react';
import { Search, Ban, CheckCircle, Shield, Trash2, Edit } from 'lucide-react';

interface User {
  id: string;
  displayName: string;
  email: string;
  photoURL: string;
  role: string;
  isActive: boolean;
  isBanned: boolean;
  banReason: string | null;
  bannedAt: string | null;
  createdAt: string;
  lastLoginAt: string;
  _count: {
    createdRaids: number;
    raidMemberships: number;
    applications: number;
  };
}

const UserManagement: React.FC = () => {
  const [users, setUsers] = useState<User[]>([]);
  const [loading, setLoading] = useState(true);
  const [search, setSearch] = useState('');
  const [filterRole, setFilterRole] = useState('');
  const [filterStatus, setFilterStatus] = useState('');
  const [selectedUser, setSelectedUser] = useState<User | null>(null);
  const [showBanModal, setShowBanModal] = useState(false);
  const [banReason, setBanReason] = useState('');
  const [banDuration, setBanDuration] = useState<'permanent' | number>('permanent');

  useEffect(() => {
    fetchUsers();
  }, [search, filterRole, filterStatus]);

  const fetchUsers = async () => {
    try {
      const params = new URLSearchParams();
      if (search) params.append('search', search);
      if (filterRole) params.append('role', filterRole);
      if (filterStatus === 'active') params.append('isActive', 'true');
      if (filterStatus === 'banned') params.append('isBanned', 'true');

      const response = await fetch(`/api/admin/users?${params}`);
      const data = await response.json();
      setUsers(data.users);
    } catch (error) {
      console.error('Failed to fetch users:', error);
    } finally {
      setLoading(false);
    }
  };

  const handleBanUser = async () => {
    if (!selectedUser || !banReason) return;

    try {
      const response = await fetch(`/api/admin/users/${selectedUser.id}/ban`, {
        method: 'PATCH',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ reason: banReason, duration: banDuration }),
      });

      if (response.ok) {
        alert('ì‚¬ìš©ìê°€ ì •ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.');
        setShowBanModal(false);
        fetchUsers();
      }
    } catch (error) {
      console.error('Failed to ban user:', error);
    }
  };

  const handleUnbanUser = async (userId: string) => {
    if (!confirm('ì´ ì‚¬ìš©ìì˜ ì •ì§€ë¥¼ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

    try {
      const response = await fetch(`/api/admin/users/${userId}/unban`, {
        method: 'PATCH',
      });

      if (response.ok) {
        alert('ì •ì§€ê°€ í•´ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
        fetchUsers();
      }
    } catch (error) {
      console.error('Failed to unban user:', error);
    }
  };

  const getRoleBadgeColor = (role: string) => {
    switch (role) {
      case 'super_admin': return 'bg-red-500';
      case 'admin': return 'bg-orange-500';
      case 'moderator': return 'bg-yellow-500';
      default: return 'bg-neutral-600';
    }
  };

  if (loading) {
    return <div className="text-center py-20 text-white">ë¡œë”© ì¤‘...</div>;
  }

  return (
    <div>
      {/* í—¤ë” */}
      <div className="mb-8">
        <h1 className="text-3xl font-bold text-white mb-2">ì‚¬ìš©ì ê´€ë¦¬</h1>
        <p className="text-neutral-400">ì „ì²´ ì‚¬ìš©ìë¥¼ ê´€ë¦¬í•˜ê³  ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤</p>
      </div>

      {/* ê²€ìƒ‰ ë° í•„í„° */}
      <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700 mb-6">
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          {/* ê²€ìƒ‰ */}
          <div className="relative">
            <Search className="absolute left-3 top-3 w-5 h-5 text-neutral-400" />
            <input
              type="text"
              placeholder="ì´ë¦„ ë˜ëŠ” ì´ë©”ì¼ ê²€ìƒ‰..."
              value={search}
              onChange={(e) => setSearch(e.target.value)}
              className="w-full pl-10 pr-4 py-2 bg-neutral-700 border border-neutral-600 rounded-lg text-white focus:outline-none focus:border-primary-500"
            />
          </div>

          {/* ì—­í•  í•„í„° */}
          <select
            value={filterRole}
            onChange={(e) => setFilterRole(e.target.value)}
            className="px-4 py-2 bg-neutral-700 border border-neutral-600 rounded-lg text-white focus:outline-none focus:border-primary-500"
          >
            <option value="">ì „ì²´ ì—­í• </option>
            <option value="user">ì¼ë°˜ ì‚¬ìš©ì</option>
            <option value="moderator">ëª¨ë”ë ˆì´í„°</option>
            <option value="admin">ê´€ë¦¬ì</option>
            <option value="super_admin">ìµœê³  ê´€ë¦¬ì</option>
          </select>

          {/* ìƒíƒœ í•„í„° */}
          <select
            value={filterStatus}
            onChange={(e) => setFilterStatus(e.target.value)}
            className="px-4 py-2 bg-neutral-700 border border-neutral-600 rounded-lg text-white focus:outline-none focus:border-primary-500"
          >
            <option value="">ì „ì²´ ìƒíƒœ</option>
            <option value="active">í™œì„±</option>
            <option value="banned">ì •ì§€</option>
          </select>
        </div>
      </div>

      {/* ì‚¬ìš©ì í…Œì´ë¸” */}
      <div className="bg-neutral-800 rounded-xl border border-neutral-700 overflow-hidden">
        <table className="w-full">
          <thead className="bg-neutral-700">
            <tr>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">ì‚¬ìš©ì</th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">ì—­í• </th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">ìƒíƒœ</th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">í™œë™</th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">ê°€ì…ì¼</th>
              <th className="px-6 py-4 text-right text-sm font-semibold text-neutral-300">ì‘ì—…</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-neutral-700">
            {users.map((user) => (
              <tr key={user.id} className="hover:bg-neutral-750">
                <td className="px-6 py-4">
                  <div className="flex items-center gap-3">
                    <img
                      src={user.photoURL || 'https://via.placeholder.com/40'}
                      alt={user.displayName}
                      className="w-10 h-10 rounded-full"
                    />
                    <div>
                      <p className="text-white font-medium">{user.displayName}</p>
                      <p className="text-neutral-400 text-sm">{user.email}</p>
                    </div>
                  </div>
                </td>
                <td className="px-6 py-4">
                  <span className={`px-3 py-1 ${getRoleBadgeColor(user.role)} text-white text-xs font-semibold rounded-full`}>
                    {user.role === 'super_admin' ? 'ìµœê³  ê´€ë¦¬ì' :
                     user.role === 'admin' ? 'ê´€ë¦¬ì' :
                     user.role === 'moderator' ? 'ëª¨ë”ë ˆì´í„°' : 'ì‚¬ìš©ì'}
                  </span>
                </td>
                <td className="px-6 py-4">
                  {user.isBanned ? (
                    <div>
                      <span className="px-3 py-1 bg-red-500 text-white text-xs font-semibold rounded-full">ì •ì§€</span>
                      {user.banReason && (
                        <p className="text-neutral-400 text-xs mt-1">{user.banReason}</p>
                      )}
                    </div>
                  ) : (
                    <span className="px-3 py-1 bg-green-500 text-white text-xs font-semibold rounded-full">í™œì„±</span>
                  )}
                </td>
                <td className="px-6 py-4">
                  <div className="text-sm text-neutral-300">
                    <p>ì›ì •ëŒ€: {user._count.createdRaids}ê°œ</p>
                    <p>ì°¸ì—¬: {user._count.raidMemberships}ê°œ</p>
                  </div>
                </td>
                <td className="px-6 py-4">
                  <p className="text-neutral-300 text-sm">
                    {new Date(user.createdAt).toLocaleDateString('ko-KR')}
                  </p>
                </td>
                <td className="px-6 py-4">
                  <div className="flex justify-end gap-2">
                    {user.isBanned ? (
                      <button
                        onClick={() => handleUnbanUser(user.id)}
                        className="p-2 text-green-400 hover:bg-neutral-700 rounded-lg transition-colors"
                        title="ì •ì§€ í•´ì œ"
                      >
                        <CheckCircle className="w-5 h-5" />
                      </button>
                    ) : (
                      <button
                        onClick={() => {
                          setSelectedUser(user);
                          setShowBanModal(true);
                        }}
                        className="p-2 text-red-400 hover:bg-neutral-700 rounded-lg transition-colors"
                        title="ì •ì§€"
                      >
                        <Ban className="w-5 h-5" />
                      </button>
                    )}
                    <button
                      className="p-2 text-blue-400 hover:bg-neutral-700 rounded-lg transition-colors"
                      title="ì—­í•  ë³€ê²½"
                    >
                      <Shield className="w-5 h-5" />
                    </button>
                  </div>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* ì •ì§€ ëª¨ë‹¬ */}
      {showBanModal && selectedUser && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-neutral-800 rounded-xl p-6 w-full max-w-md border border-neutral-700">
            <h3 className="text-xl font-bold text-white mb-4">ì‚¬ìš©ì ì •ì§€</h3>
            
            <div className="mb-4">
              <p className="text-neutral-300 mb-2">
                <strong>{selectedUser.displayName}</strong>ì„(ë¥¼) ì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
              </p>
            </div>

            <div className="mb-4">
              <label className="block text-sm font-medium text-neutral-300 mb-2">
                ì •ì§€ ì‚¬ìœ  *
              </label>
              <textarea
                value={banReason}
                onChange={(e) => setBanReason(e.target.value)}
                rows={3}
                className="w-full px-4 py-2 bg-neutral-700 border border-neutral-600 rounded-lg text-white focus:outline-none focus:border-primary-500"
                placeholder="ì •ì§€ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
              />
            </div>

            <div className="mb-6">
              <label className="block text-sm font-medium text-neutral-300 mb-2">
                ì •ì§€ ê¸°ê°„
              </label>
              <select
                value={banDuration}
                onChange={(e) => setBanDuration(e.target.value === 'permanent' ? 'permanent' : parseInt(e.target.value))}
                className="w-full px-4 py-2 bg-neutral-700 border border-neutral-600 rounded-lg text-white focus:outline-none focus:border-primary-500"
              >
                <option value="permanent">ì˜êµ¬ ì •ì§€</option>
                <option value="7">7ì¼</option>
                <option value="14">14ì¼</option>
                <option value="30">30ì¼</option>
              </select>
            </div>

            <div className="flex justify-end gap-3">
              <button
                onClick={() => {
                  setShowBanModal(false);
                  setBanReason('');
                }}
                className="px-4 py-2 bg-neutral-700 text-white rounded-lg hover:bg-neutral-600 transition-colors"
              >
                ì·¨ì†Œ
              </button>
              <button
                onClick={handleBanUser}
                disabled={!banReason}
                className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
              >
                ì •ì§€
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

export default UserManagement;
```

---

## 7. í†µê³„ ë° ë¶„ì„ ëŒ€ì‹œë³´ë“œ

### 7.1 í†µê³„ ê³„ì‚° ìœ í‹¸ë¦¬í‹°

#### `server/src/utils/statistics.ts`

```typescript
import { prisma } from '../index';

/**
 * íŠ¹ì • ê¸°ê°„ì˜ ì‚¬ìš©ì ì¦ê°€ìœ¨ ê³„ì‚°
 */
export async function calculateUserGrowthRate(days: number = 30): Promise<number> {
  const startDate = new Date(Date.now() - days * 24 * 60 * 60 * 1000);
  const previousPeriodStart = new Date(startDate.getTime() - days * 24 * 60 * 60 * 1000);

  const [currentPeriod, previousPeriod] = await Promise.all([
    prisma.user.count({
      where: { createdAt: { gte: startDate } }
    }),
    prisma.user.count({
      where: {
        createdAt: {
          gte: previousPeriodStart,
          lt: startDate
        }
      }
    })
  ]);

  if (previousPeriod === 0) return 100;
  return ((currentPeriod - previousPeriod) / previousPeriod) * 100;
}

/**
 * íŒ€ êµ¬ì„± ì„±ê³µë¥  ë¶„ì„
 */
export async function analyzeTeamFormationSuccess() {
  const [totalRaids, completedRaids, activeRaids] = await Promise.all([
    prisma.raid.count(),
    prisma.raid.count({ where: { status: 'completed' } }),
    prisma.raid.count({ where: { status: 'active' } }),
  ]);

  return {
    total: totalRaids,
    completed: completedRaids,
    active: activeRaids,
    successRate: totalRaids > 0 ? (completedRaids / totalRaids) * 100 : 0,
  };
}

/**
 * í‰ê·  ë§¤ì¹­ ì‹œê°„ ê³„ì‚° (ì§€ì› â†’ ìˆ˜ë½)
 */
export async function calculateAverageMatchingTime(): Promise<number> {
  const acceptedApplications = await prisma.application.findMany({
    where: {
      status: 'accepted',
      respondedAt: { not: null }
    },
    select: {
      appliedAt: true,
      respondedAt: true,
    }
  });

  if (acceptedApplications.length === 0) return 0;

  const totalTime = acceptedApplications.reduce((sum, app) => {
    if (!app.respondedAt) return sum;
    const diff = new Date(app.respondedAt).getTime() - new Date(app.appliedAt).getTime();
    return sum + diff;
  }, 0);

  // ë°€ë¦¬ì´ˆë¥¼ ì‹œê°„ìœ¼ë¡œ ë³€í™˜
  return totalTime / acceptedApplications.length / (1000 * 60 * 60);
}

/**
 * ì¸ê¸° ìˆëŠ” ì—­í•  ë¶„ì„
 */
export async function analyzePopularRoles() {
  const applications = await prisma.application.groupBy({
    by: ['appliedRole'],
    _count: {
      appliedRole: true
    },
    orderBy: {
      _count: {
        appliedRole: 'desc'
      }
    },
    take: 10
  });

  return applications.map(item => ({
    role: item.appliedRole,
    count: item._count.appliedRole
  }));
}
```

---

## 8. ë³´ì•ˆ ë° ê°ì‚¬ ë¡œê·¸

### 8.1 ê°ì‚¬ ë¡œê·¸ ì¡°íšŒ í˜ì´ì§€

#### `client/src/pages/admin/AuditLogs.tsx`

```typescript
import React, { useEffect, useState } from 'react';
import { FileText, Filter } from 'lucide-react';

interface AuditLog {
  id: string;
  userId: string;
  user: {
    displayName: string;
    email: string;
  };
  action: string;
  targetType: string | null;
  targetId: string | null;
  details: any;
  ipAddress: string | null;
  createdAt: string;
}

const AuditLogs: React.FC = () => {
  const [logs, setLogs] = useState<AuditLog[]>([]);
  const [loading, setLoading] = useState(true);
  const [filterAction, setFilterAction] = useState('');
  const [page, setPage] = useState(1);
  const [total, setTotal] = useState(0);

  useEffect(() => {
    fetchLogs();
  }, [filterAction, page]);

  const fetchLogs = async () => {
    try {
      const params = new URLSearchParams();
      if (filterAction) params.append('action', filterAction);
      params.append('page', page.toString());
      params.append('limit', '50');

      const response = await fetch(`/api/admin/audit-logs?${params}`);
      const data = await response.json();
      setLogs(data.logs);
      setTotal(data.pagination.total);
    } catch (error) {
      console.error('Failed to fetch audit logs:', error);
    } finally {
      setLoading(false);
    }
  };

  const getActionLabel = (action: string) => {
    const labels: Record<string, string> = {
      'user_banned': 'ì‚¬ìš©ì ì •ì§€',
      'user_unbanned': 'ì •ì§€ í•´ì œ',
      'user_role_updated': 'ì—­í•  ë³€ê²½',
      'user_deleted': 'ì‚¬ìš©ì ì‚­ì œ',
      'competition_created': 'ëŒ€íšŒ ìƒì„±',
      'competition_updated': 'ëŒ€íšŒ ìˆ˜ì •',
      'competition_deleted': 'ëŒ€íšŒ ì‚­ì œ',
      'raid_deleted': 'ì›ì •ëŒ€ ì‚­ì œ',
      'report_resolved': 'ì‹ ê³  ì²˜ë¦¬',
      'report_rejected': 'ì‹ ê³  ê±°ë¶€',
    };
    return labels[action] || action;
  };

  const getActionColor = (action: string) => {
    if (action.includes('deleted') || action.includes('banned')) return 'text-red-400';
    if (action.includes('created') || action.includes('unbanned')) return 'text-green-400';
    if (action.includes('updated')) return 'text-yellow-400';
    return 'text-blue-400';
  };

  if (loading) {
    return <div className="text-center py-20 text-white">ë¡œë”© ì¤‘...</div>;
  }

  return (
    <div>
      {/* í—¤ë” */}
      <div className="mb-8">
        <h1 className="text-3xl font-bold text-white mb-2">ê°ì‚¬ ë¡œê·¸</h1>
        <p className="text-neutral-400">ê´€ë¦¬ì í™œë™ ê¸°ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤</p>
      </div>

      {/* í•„í„° */}
      <div className="bg-neutral-800 rounded-xl p-6 border border-neutral-700 mb-6">
        <div className="flex items-center gap-4">
          <Filter className="w-5 h-5 text-neutral-400" />
          <select
            value={filterAction}
            onChange={(e) => setFilterAction(e.target.value)}
            className="px-4 py-2 bg-neutral-700 border border-neutral-600 rounded-lg text-white focus:outline-none focus:border-primary-500"
          >
            <option value="">ì „ì²´ í™œë™</option>
            <option value="user_banned">ì‚¬ìš©ì ì •ì§€</option>
            <option value="user_unbanned">ì •ì§€ í•´ì œ</option>
            <option value="competition_created">ëŒ€íšŒ ìƒì„±</option>
            <option value="raid_deleted">ì›ì •ëŒ€ ì‚­ì œ</option>
            <option value="report_resolved">ì‹ ê³  ì²˜ë¦¬</option>
          </select>
          <span className="text-neutral-400 text-sm">
            ì´ {total.toLocaleString()}ê±´ì˜ ë¡œê·¸
          </span>
        </div>
      </div>

      {/* ë¡œê·¸ í…Œì´ë¸” */}
      <div className="bg-neutral-800 rounded-xl border border-neutral-700 overflow-hidden">
        <table className="w-full">
          <thead className="bg-neutral-700">
            <tr>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">ì‹œê°„</th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">ê´€ë¦¬ì</th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">í™œë™</th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">ëŒ€ìƒ</th>
              <th className="px-6 py-4 text-left text-sm font-semibold text-neutral-300">IP ì£¼ì†Œ</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-neutral-700">
            {logs.map((log) => (
              <tr key={log.id} className="hover:bg-neutral-750">
                <td className="px-6 py-4">
                  <p className="text-neutral-300 text-sm">
                    {new Date(log.createdAt).toLocaleString('ko-KR')}
                  </p>
                </td>
                <td className="px-6 py-4">
                  <div>
                    <p className="text-white font-medium">{log.user.displayName}</p>
                    <p className="text-neutral-400 text-xs">{log.user.email}</p>
                  </div>
                </td>
                <td className="px-6 py-4">
                  <span className={`font-medium ${getActionColor(log.action)}`}>
                    {getActionLabel(log.action)}
                  </span>
                </td>
                <td className="px-6 py-4">
                  <div className="text-sm text-neutral-300">
                    <p>{log.targetType || '-'}</p>
                    {log.targetId && (
                      <p className="text-neutral-500 text-xs font-mono">{log.targetId}</p>
                    )}
                  </div>
                </td>
                <td className="px-6 py-4">
                  <p className="text-neutral-400 text-sm font-mono">
                    {log.ipAddress || '-'}
                  </p>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* í˜ì´ì§€ë„¤ì´ì…˜ */}
      <div className="mt-6 flex justify-center gap-2">
        <button
          onClick={() => setPage(page - 1)}
          disabled={page === 1}
          className="px-4 py-2 bg-neutral-700 text-white rounded-lg hover:bg-neutral-600 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          ì´ì „
        </button>
        <span className="px-4 py-2 text-white">
          {page} / {Math.ceil(total / 50)}
        </span>
        <button
          onClick={() => setPage(page + 1)}
          disabled={page >= Math.ceil(total / 50)}
          className="px-4 py-2 bg-neutral-700 text-white rounded-lg hover:bg-neutral-600 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          ë‹¤ìŒ
        </button>
      </div>
    </div>
  );
};

export default AuditLogs;
```

---

## 9. ì²´í¬ë¦¬ìŠ¤íŠ¸

### 9.1 ê´€ë¦¬ì ì‹œìŠ¤í…œ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### ë°±ì—”ë“œ
- [ ] User ëª¨ë¸ì— role, isBanned í•„ë“œ ì¶”ê°€
- [ ] Report ëª¨ë¸ ìƒì„±
- [ ] AuditLog ëª¨ë¸ ìƒì„±
- [ ] ê¶Œí•œ ì²´í¬ ë¯¸ë“¤ì›¨ì–´ êµ¬í˜„
- [ ] ê´€ë¦¬ì API ë¼ìš°íŠ¸ êµ¬í˜„
- [ ] ëŒ€ì‹œë³´ë“œ í†µê³„ API êµ¬í˜„
- [ ] ì‚¬ìš©ì ê´€ë¦¬ API êµ¬í˜„
- [ ] ì‹ ê³  ê´€ë¦¬ API êµ¬í˜„
- [ ] ê°ì‚¬ ë¡œê·¸ ìœ í‹¸ë¦¬í‹° êµ¬í˜„

#### í”„ë¡ íŠ¸ì—”ë“œ
- [ ] AdminLayout ì»´í¬ë„ŒíŠ¸ ìƒì„±
- [ ] AdminRoute ê¶Œí•œ ì²´í¬ êµ¬í˜„
- [ ] AdminDashboard í˜ì´ì§€ êµ¬í˜„
- [ ] UserManagement í˜ì´ì§€ êµ¬í˜„
- [ ] CompetitionManagement í˜ì´ì§€ êµ¬í˜„
- [ ] RaidManagement í˜ì´ì§€ êµ¬í˜„
- [ ] ReportManagement í˜ì´ì§€ êµ¬í˜„
- [ ] AuditLogs í˜ì´ì§€ êµ¬í˜„
- [ ] Chart.js ì„¤ì¹˜ ë° ì°¨íŠ¸ êµ¬í˜„

#### ë³´ì•ˆ
- [ ] Super Admin ê³„ì • ì´ˆê¸°í™”
- [ ] ëª¨ë“  ê´€ë¦¬ì APIì— ê¶Œí•œ ì²´í¬ ì ìš©
- [ ] IP ì£¼ì†Œ ë° User Agent ë¡œê¹…
- [ ] Rate Limiting ê°•í™”
- [ ] CSRF ë³´í˜¸ êµ¬í˜„

---

## 10. ë°°í¬ ê°€ì´ë“œ

### 10.1 Super Admin ì´ˆê¸°í™”

í”„ë¡œë•ì…˜ ë°°í¬ ì „ ìµœì´ˆ Super Admin ê³„ì •ì„ ìƒì„±í•´ì•¼ í•©ë‹ˆë‹¤.

#### ë°©ë²• 1: ë°ì´í„°ë² ì´ìŠ¤ ì§ì ‘ ìˆ˜ì •
```sql
-- Prisma Studioì—ì„œ ì‹¤í–‰
UPDATE "User" 
SET role = 'super_admin' 
WHERE email = 'admin@dacon-raid.com';
```

#### ë°©ë²• 2: ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
```typescript
// server/scripts/init-admin.ts
import { prisma } from '../src/index';

async function initSuperAdmin() {
  const email = process.env.SUPER_ADMIN_EMAIL;
  
  if (!email) {
    console.error('SUPER_ADMIN_EMAIL is not set');
    process.exit(1);
  }

  const user = await prisma.user.update({
    where: { email },
    data: { role: 'super_admin' }
  });

  console.log(`Super admin initialized: ${user.email}`);
}

initSuperAdmin();
```

ì‹¤í–‰:
```bash
cd server
SUPER_ADMIN_EMAIL=admin@dacon-raid.com npm run init-admin
```

---

## 11. ì°¸ê³  ìë£Œ

### 11.1 ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

```bash
cd client
npm install chart.js react-chartjs-2
```

### 11.2 ì¶”ì²œ ë„êµ¬

- **Prisma Studio**: ë°ì´í„°ë² ì´ìŠ¤ GUI
- **Postman**: API í…ŒìŠ¤íŠ¸
- **Sentry**: ì—ëŸ¬ ëª¨ë‹ˆí„°ë§ (í”„ë¡œë•ì…˜)

---

## 12. ë§ˆë¬´ë¦¬

ì´ ê°€ì´ë“œë¥¼ ë”°ë¼ êµ¬í˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ **ì™„ì „í•œ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ**ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

âœ… **í†µê³„ ëŒ€ì‹œë³´ë“œ** - ì‹¤ì‹œê°„ KPI ë° ì°¨íŠ¸  
âœ… **ì‚¬ìš©ì ê´€ë¦¬** - ì •ì§€, ê¶Œí•œ ë¶€ì—¬, ì‚­ì œ  
âœ… **ëŒ€íšŒ ê´€ë¦¬** - CRUD ë° í™œì„±í™” ê´€ë¦¬  
âœ… **ì›ì •ëŒ€ ê´€ë¦¬** - ëª¨ë‹ˆí„°ë§ ë° ì‚­ì œ  
âœ… **ì‹ ê³  ê´€ë¦¬** - ì²˜ë¦¬ ë° ì¡°ì¹˜  
âœ… **ê°ì‚¬ ë¡œê·¸** - ëª¨ë“  ê´€ë¦¬ì í™œë™ ê¸°ë¡

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ì‘ì„±ì¼**: 2025ë…„ 11ì›” 1ì¼  
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: ì‚¬ìš©ì í”¼ë“œë°± ë°˜ì˜ í›„
